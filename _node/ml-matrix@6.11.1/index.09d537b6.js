import*as Pt from"../is-any-array@2.0.1/index.9a6f9b53.js";import*as Lt from"../ml-array-rescale@1.3.7/index.66e8218d.js";function pt(n){return n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var I={},jt=pt(Pt),Ut=pt(Lt);Object.defineProperty(I,"__esModule",{value:!0});var O=jt,dt=Ut;const ot=" ".repeat(2),yt=" ".repeat(4);function Ot(){return Mt(this)}function Mt(n,e={}){const{maxRows:t=15,maxColumns:r=10,maxNumSize:s=8,padMinus:o="auto"}=e;return`${n.constructor.name} {
${ot}[
${yt}${Qt(n,t,r,s,o)}
${ot}]
${ot}rows: ${n.rows}
${ot}columns: ${n.columns}
}`}function Qt(n,e,t,r,s){const{rows:o,columns:i}=n,h=Math.min(o,e),l=Math.min(i,t),u=[];if(s==="auto"){s=!1;t:for(let m=0;m<h;m++)for(let a=0;a<l;a++)if(n.get(m,a)<0){s=!0;break t}}for(let m=0;m<h;m++){let a=[];for(let w=0;w<l;w++)a.push(Wt(n.get(m,w),r,s));u.push(`${a.join(" ")}`)}return l!==i&&(u[u.length-1]+=` ... ${i-t} more columns`),h!==o&&u.push(`... ${o-e} more rows`),u.join(`
${yt}`)}function Wt(n,e,t){return(n>=0&&t?` ${bt(n,e-1)}`:bt(n,e)).padEnd(e)}function bt(n,e){let t=n.toString();if(t.length<=e)return t;let r=n.toFixed(e);if(r.length>e&&(r=n.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let s=n.toExponential(e);return s.length>e&&(s=n.toExponential(Math.max(0,e-(s.length-e)))),s.slice(0)}function Yt(n,e){n.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},n.prototype.addS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)+t);return this},n.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)+t.get(r,s));return this},n.add=function(t,r){return new e(t).add(r)},n.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},n.prototype.subS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)-t);return this},n.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)-t.get(r,s));return this},n.sub=function(t,r){return new e(t).sub(r)},n.prototype.subtract=n.prototype.sub,n.prototype.subtractS=n.prototype.subS,n.prototype.subtractM=n.prototype.subM,n.subtract=n.sub,n.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},n.prototype.mulS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)*t);return this},n.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)*t.get(r,s));return this},n.mul=function(t,r){return new e(t).mul(r)},n.prototype.multiply=n.prototype.mul,n.prototype.multiplyS=n.prototype.mulS,n.prototype.multiplyM=n.prototype.mulM,n.multiply=n.mul,n.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},n.prototype.divS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)/t);return this},n.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)/t.get(r,s));return this},n.div=function(t,r){return new e(t).div(r)},n.prototype.divide=n.prototype.div,n.prototype.divideS=n.prototype.divS,n.prototype.divideM=n.prototype.divM,n.divide=n.div,n.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},n.prototype.modS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)%t);return this},n.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)%t.get(r,s));return this},n.mod=function(t,r){return new e(t).mod(r)},n.prototype.modulus=n.prototype.mod,n.prototype.modulusS=n.prototype.modS,n.prototype.modulusM=n.prototype.modM,n.modulus=n.mod,n.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},n.prototype.andS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)&t);return this},n.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)&t.get(r,s));return this},n.and=function(t,r){return new e(t).and(r)},n.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},n.prototype.orS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)|t);return this},n.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)|t.get(r,s));return this},n.or=function(t,r){return new e(t).or(r)},n.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},n.prototype.xorS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)^t);return this},n.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)^t.get(r,s));return this},n.xor=function(t,r){return new e(t).xor(r)},n.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},n.prototype.leftShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)<<t);return this},n.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)<<t.get(r,s));return this},n.leftShift=function(t,r){return new e(t).leftShift(r)},n.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},n.prototype.signPropagatingRightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>t);return this},n.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>t.get(r,s));return this},n.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},n.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},n.prototype.rightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>>t);return this},n.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>>t.get(r,s));return this},n.rightShift=function(t,r){return new e(t).rightShift(r)},n.prototype.zeroFillRightShift=n.prototype.rightShift,n.prototype.zeroFillRightShiftS=n.prototype.rightShiftS,n.prototype.zeroFillRightShiftM=n.prototype.rightShiftM,n.zeroFillRightShift=n.rightShift,n.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},n.not=function(t){return new e(t).not()},n.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},n.abs=function(t){return new e(t).abs()},n.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},n.acos=function(t){return new e(t).acos()},n.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},n.acosh=function(t){return new e(t).acosh()},n.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},n.asin=function(t){return new e(t).asin()},n.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},n.asinh=function(t){return new e(t).asinh()},n.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},n.atan=function(t){return new e(t).atan()},n.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},n.atanh=function(t){return new e(t).atanh()},n.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},n.cbrt=function(t){return new e(t).cbrt()},n.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},n.ceil=function(t){return new e(t).ceil()},n.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},n.clz32=function(t){return new e(t).clz32()},n.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},n.cos=function(t){return new e(t).cos()},n.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},n.cosh=function(t){return new e(t).cosh()},n.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},n.exp=function(t){return new e(t).exp()},n.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},n.expm1=function(t){return new e(t).expm1()},n.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},n.floor=function(t){return new e(t).floor()},n.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},n.fround=function(t){return new e(t).fround()},n.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},n.log=function(t){return new e(t).log()},n.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},n.log1p=function(t){return new e(t).log1p()},n.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},n.log10=function(t){return new e(t).log10()},n.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},n.log2=function(t){return new e(t).log2()},n.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},n.round=function(t){return new e(t).round()},n.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},n.sign=function(t){return new e(t).sign()},n.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},n.sin=function(t){return new e(t).sin()},n.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},n.sinh=function(t){return new e(t).sinh()},n.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},n.sqrt=function(t){return new e(t).sqrt()},n.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},n.tan=function(t){return new e(t).tan()},n.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},n.tanh=function(t){return new e(t).tanh()},n.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},n.trunc=function(t){return new e(t).trunc()},n.pow=function(t,r){return new e(t).pow(r)},n.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},n.prototype.powS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)**t);return this},n.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)**t.get(r,s));return this}}function B(n,e,t){let r=t?n.rows:n.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function J(n,e,t){let r=t?n.columns:n.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function tt(n,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==n.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function rt(n,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==n.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function ft(n,e){if(!O.isAnyArray(e))throw new TypeError("row indices must be an array");for(let t=0;t<e.length;t++)if(e[t]<0||e[t]>=n.rows)throw new RangeError("row indices are out of range")}function mt(n,e){if(!O.isAnyArray(e))throw new TypeError("column indices must be an array");for(let t=0;t<e.length;t++)if(e[t]<0||e[t]>=n.columns)throw new RangeError("column indices are out of range")}function gt(n,e,t,r,s){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(it("startRow",e),it("endRow",t),it("startColumn",r),it("endColumn",s),e>t||r>s||e<0||e>=n.rows||t<0||t>=n.rows||r<0||r>=n.columns||s<0||s>=n.columns)throw new RangeError("Submatrix indices are out of range")}function nt(n,e=0){let t=[];for(let r=0;r<n;r++)t.push(e);return t}function it(n,e){if(typeof e!="number")throw new TypeError(`${n} must be a number`)}function et(n){if(n.isEmpty())throw new Error("Empty matrix has no elements to index")}function Bt(n){let e=nt(n.rows);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[t]+=n.get(t,r);return e}function Jt(n){let e=nt(n.columns);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[r]+=n.get(t,r);return e}function Kt(n){let e=0;for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)e+=n.get(t,r);return e}function Gt(n){let e=nt(n.rows,1);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[t]*=n.get(t,r);return e}function Xt(n){let e=nt(n.columns,1);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[r]*=n.get(t,r);return e}function Zt(n){let e=1;for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)e*=n.get(t,r);return e}function Ht(n,e,t){const r=n.rows,s=n.columns,o=[];for(let i=0;i<r;i++){let h=0,l=0,u=0;for(let m=0;m<s;m++)u=n.get(i,m)-t[i],h+=u,l+=u*u;e?o.push((l-h*h/s)/(s-1)):o.push((l-h*h/s)/s)}return o}function _t(n,e,t){const r=n.rows,s=n.columns,o=[];for(let i=0;i<s;i++){let h=0,l=0,u=0;for(let m=0;m<r;m++)u=n.get(m,i)-t[i],h+=u,l+=u*u;e?o.push((l-h*h/r)/(r-1)):o.push((l-h*h/r)/r)}return o}function tr(n,e,t){const r=n.rows,s=n.columns,o=r*s;let i=0,h=0,l=0;for(let u=0;u<r;u++)for(let m=0;m<s;m++)l=n.get(u,m)-t,i+=l,h+=l*l;return e?(h-i*i/o)/(o-1):(h-i*i/o)/o}function rr(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e[t])}function er(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e[r])}function sr(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e)}function or(n){const e=[];for(let t=0;t<n.rows;t++){let r=0;for(let s=0;s<n.columns;s++)r+=n.get(t,s)**2/(n.columns-1);e.push(Math.sqrt(r))}return e}function nr(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e[t])}function ir(n){const e=[];for(let t=0;t<n.columns;t++){let r=0;for(let s=0;s<n.rows;s++)r+=n.get(s,t)**2/(n.rows-1);e.push(Math.sqrt(r))}return e}function hr(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e[r])}function lr(n){const e=n.size-1;let t=0;for(let r=0;r<n.columns;r++)for(let s=0;s<n.rows;s++)t+=n.get(s,r)**2/e;return Math.sqrt(t)}function ur(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e)}class N{static from1DArray(e,t,r){if(e*t!==r.length)throw new RangeError("data length does not match given dimensions");let s=new x(e,t);for(let o=0;o<e;o++)for(let i=0;i<t;i++)s.set(o,i,r[o*t+i]);return s}static rowVector(e){let t=new x(1,e.length);for(let r=0;r<e.length;r++)t.set(0,r,e[r]);return t}static columnVector(e){let t=new x(e.length,1);for(let r=0;r<e.length;r++)t.set(r,0,e[r]);return t}static zeros(e,t){return new x(e,t)}static ones(e,t){return new x(e,t).fill(1)}static rand(e,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{random:s=Math.random}=r;let o=new x(e,t);for(let i=0;i<e;i++)for(let h=0;h<t;h++)o.set(i,h,s());return o}static randInt(e,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:s=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(s>=o)throw new RangeError("min must be smaller than max");let h=o-s,l=new x(e,t);for(let u=0;u<e;u++)for(let m=0;m<t;m++){let a=s+Math.round(i()*h);l.set(u,m,a)}return l}static eye(e,t,r){t===void 0&&(t=e),r===void 0&&(r=1);let s=Math.min(e,t),o=this.zeros(e,t);for(let i=0;i<s;i++)o.set(i,i,r);return o}static diag(e,t,r){let s=e.length;t===void 0&&(t=s),r===void 0&&(r=t);let o=Math.min(s,t,r),i=this.zeros(t,r);for(let h=0;h<o;h++)i.set(h,h,e[h]);return i}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let r=e.rows,s=e.columns,o=new x(r,s);for(let i=0;i<r;i++)for(let h=0;h<s;h++)o.set(i,h,Math.min(e.get(i,h),t.get(i,h)));return o}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let r=e.rows,s=e.columns,o=new this(r,s);for(let i=0;i<r;i++)for(let h=0;h<s;h++)o.set(i,h,Math.max(e.get(i,h),t.get(i,h)));return o}static checkMatrix(e){return N.isMatrix(e)?e:new x(e)}static isMatrix(e){return e!=null&&e.klass==="Matrix"}get size(){return this.rows*this.columns}apply(e){if(typeof e!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.call(this,t,r);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let r=0;r<this.columns;r++)e[t].push(this.get(t,r))}return e}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let e=0;e<this.rows;e++)if(this.get(e,e)!==0)return!1;return!0}isEchelonForm(){let e=0,t=0,r=-1,s=!0,o=!1;for(;e<this.rows&&s;){for(t=0,o=!1;t<this.columns&&o===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>r?(o=!0,r=t):(s=!1,o=!0);e++}return s}isReducedEchelonForm(){let e=0,t=0,r=-1,s=!0,o=!1;for(;e<this.rows&&s;){for(t=0,o=!1;t<this.columns&&o===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>r?(o=!0,r=t):(s=!1,o=!0);for(let i=t+1;i<this.rows;i++)this.get(e,i)!==0&&(s=!1);e++}return s}echelonForm(){let e=this.clone(),t=0,r=0;for(;t<e.rows&&r<e.columns;){let s=t;for(let o=t;o<e.rows;o++)e.get(o,r)>e.get(s,r)&&(s=o);if(e.get(s,r)===0)r++;else{e.swapRows(t,s);let o=e.get(t,r);for(let i=r;i<e.columns;i++)e.set(t,i,e.get(t,i)/o);for(let i=t+1;i<e.rows;i++){let h=e.get(i,r)/e.get(t,r);e.set(i,r,0);for(let l=r+1;l<e.columns;l++)e.set(i,l,e.get(i,l)-e.get(t,l)*h)}t++,r++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,r=e.rows,s=r-1;for(;s>=0;)if(e.maxRow(s)===0)s--;else{let o=0,i=!1;for(;o<r&&i===!1;)e.get(s,o)===1?i=!0:o++;for(let h=0;h<s;h++){let l=e.get(h,o);for(let u=o;u<t;u++){let m=e.get(h,u)-l*e.get(s,u);e.set(h,u,m)}}s--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:r=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let s=new x(this.rows*t,this.columns*r);for(let o=0;o<t;o++)for(let i=0;i<r;i++)s.setSubMatrix(this,this.rows*o,this.columns*i);return s}fill(e){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,e);return this}neg(){return this.mulS(-1)}getRow(e){B(this,e);let t=[];for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}getRowVector(e){return x.rowVector(this.getRow(e))}setRow(e,t){B(this,e),t=tt(this,t);for(let r=0;r<this.columns;r++)this.set(e,r,t[r]);return this}swapRows(e,t){B(this,e),B(this,t);for(let r=0;r<this.columns;r++){let s=this.get(e,r);this.set(e,r,this.get(t,r)),this.set(t,r,s)}return this}getColumn(e){J(this,e);let t=[];for(let r=0;r<this.rows;r++)t.push(this.get(r,e));return t}getColumnVector(e){return x.columnVector(this.getColumn(e))}setColumn(e,t){J(this,e),t=rt(this,t);for(let r=0;r<this.rows;r++)this.set(r,e,t[r]);return this}swapColumns(e,t){J(this,e),J(this,t);for(let r=0;r<this.rows;r++){let s=this.get(r,e);this.set(r,e,this.get(r,t)),this.set(r,t,s)}return this}addRowVector(e){e=tt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+e[r]);return this}subRowVector(e){e=tt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-e[r]);return this}mulRowVector(e){e=tt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e[r]);return this}divRowVector(e){e=tt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/e[r]);return this}addColumnVector(e){e=rt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+e[t]);return this}subColumnVector(e){e=rt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-e[t]);return this}mulColumnVector(e){e=rt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e[t]);return this}divColumnVector(e){e=rt(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/e[t]);return this}mulRow(e,t){B(this,e);for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this}mulColumn(e,t){J(this,e);for(let r=0;r<this.rows;r++)this.set(r,e,this.get(r,e)*t);return this}max(e){if(this.isEmpty())return NaN;switch(e){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t[r]&&(t[r]=this.get(r,s));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t[s]&&(t[s]=this.get(r,s));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s));return t}default:throw new Error(`invalid option: ${e}`)}}maxIndex(){et(this);let e=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>e&&(e=this.get(r,s),t[0]=r,t[1]=s);return t}min(e){if(this.isEmpty())return NaN;switch(e){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t[r]&&(t[r]=this.get(r,s));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t[s]&&(t[s]=this.get(r,s));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s));return t}default:throw new Error(`invalid option: ${e}`)}}minIndex(){et(this);let e=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<e&&(e=this.get(r,s),t[0]=r,t[1]=s);return t}maxRow(e){if(B(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxRowIndex(e){B(this,e),et(this);let t=this.get(e,0),r=[e,0];for(let s=1;s<this.columns;s++)this.get(e,s)>t&&(t=this.get(e,s),r[1]=s);return r}minRow(e){if(B(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minRowIndex(e){B(this,e),et(this);let t=this.get(e,0),r=[e,0];for(let s=1;s<this.columns;s++)this.get(e,s)<t&&(t=this.get(e,s),r[1]=s);return r}maxColumn(e){if(J(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxColumnIndex(e){J(this,e),et(this);let t=this.get(0,e),r=[0,e];for(let s=1;s<this.rows;s++)this.get(s,e)>t&&(t=this.get(s,e),r[0]=s);return r}minColumn(e){if(J(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e));return t}minColumnIndex(e){J(this,e),et(this);let t=this.get(0,e),r=[0,e];for(let s=1;s<this.rows;s++)this.get(s,e)<t&&(t=this.get(s,e),r[0]=s);return r}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let r=0;r<e;r++)t.push(this.get(r,r));return t}norm(e="frobenius"){switch(e){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${e}`)}}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r),this.set(t,r,e);return this}dot(e){N.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let r=0;for(let s=0;s<t.length;s++)r+=t[s]*e[s];return r}mmul(e){e=x.checkMatrix(e);let t=this.rows,r=this.columns,s=e.columns,o=new x(t,s),i=new Float64Array(r);for(let h=0;h<s;h++){for(let l=0;l<r;l++)i[l]=e.get(l,h);for(let l=0;l<t;l++){let u=0;for(let m=0;m<r;m++)u+=this.get(l,m)*i[m];o.set(l,h,u)}}return o}strassen2x2(e){e=x.checkMatrix(e);let t=new x(2,2);const r=this.get(0,0),s=e.get(0,0),o=this.get(0,1),i=e.get(0,1),h=this.get(1,0),l=e.get(1,0),u=this.get(1,1),m=e.get(1,1),a=(r+u)*(s+m),w=(h+u)*s,b=r*(i-m),g=u*(l-s),p=(r+o)*m,S=(h-r)*(s+i),c=(o-u)*(l+m),M=a+g-p+c,v=b+p,k=w+g,V=a-w+b+S;return t.set(0,0,M),t.set(0,1,v),t.set(1,0,k),t.set(1,1,V),t}strassen3x3(e){e=x.checkMatrix(e);let t=new x(3,3);const r=this.get(0,0),s=this.get(0,1),o=this.get(0,2),i=this.get(1,0),h=this.get(1,1),l=this.get(1,2),u=this.get(2,0),m=this.get(2,1),a=this.get(2,2),w=e.get(0,0),b=e.get(0,1),g=e.get(0,2),p=e.get(1,0),S=e.get(1,1),c=e.get(1,2),M=e.get(2,0),v=e.get(2,1),k=e.get(2,2),V=(r+s+o-i-h-m-a)*S,T=(r-i)*(-b+S),R=h*(-w+b+p-S-c-M+k),A=(-r+i+h)*(w-b+S),q=(i+h)*(-w+b),f=r*w,d=(-r+u+m)*(w-g+c),E=(-r+u)*(g-c),y=(u+m)*(-w+g),z=(r+s+o-h-l-u-m)*c,D=m*(-w+g+p-S-c-M+v),F=(-o+m+a)*(S+M-v),$=(o-a)*(S-v),j=o*M,K=(m+a)*(-M+v),P=(-o+h+l)*(c+M-k),G=(o-l)*(c-k),X=(h+l)*(-M+k),C=s*p,U=l*v,Q=i*g,W=u*b,L=a*k,Nt=f+j+C,It=V+A+q+f+F+j+K,Ct=f+d+y+z+j+P+X,Dt=T+R+A+f+j+P+G,qt=T+A+q+f+U,Ft=j+P+G+X+Q,Tt=f+d+E+D+F+$+j,zt=F+$+j+K+W,$t=f+d+E+y+L;return t.set(0,0,Nt),t.set(0,1,It),t.set(0,2,Ct),t.set(1,0,Dt),t.set(1,1,qt),t.set(1,2,Ft),t.set(2,0,Tt),t.set(2,1,zt),t.set(2,2,$t),t}mmulStrassen(e){e=x.checkMatrix(e);let t=this.clone(),r=t.rows,s=t.columns,o=e.rows,i=e.columns;s!==o&&console.warn(`Multiplying ${r} x ${s} and ${o} x ${i} matrix: dimensions do not match.`);function h(a,w,b){let g=a.rows,p=a.columns;if(g===w&&p===b)return a;{let S=N.zeros(w,b);return S=S.setSubMatrix(a,0,0),S}}let l=Math.max(r,o),u=Math.max(s,i);t=h(t,l,u),e=h(e,l,u);function m(a,w,b,g){if(b<=512||g<=512)return a.mmul(w);b%2===1&&g%2===1?(a=h(a,b+1,g+1),w=h(w,b+1,g+1)):b%2===1?(a=h(a,b+1,g),w=h(w,b+1,g)):g%2===1&&(a=h(a,b,g+1),w=h(w,b,g+1));let p=parseInt(a.rows/2,10),S=parseInt(a.columns/2,10),c=a.subMatrix(0,p-1,0,S-1),M=w.subMatrix(0,p-1,0,S-1),v=a.subMatrix(0,p-1,S,a.columns-1),k=w.subMatrix(0,p-1,S,w.columns-1),V=a.subMatrix(p,a.rows-1,0,S-1),T=w.subMatrix(p,w.rows-1,0,S-1),R=a.subMatrix(p,a.rows-1,S,a.columns-1),A=w.subMatrix(p,w.rows-1,S,w.columns-1),q=m(N.add(c,R),N.add(M,A),p,S),f=m(N.add(V,R),M,p,S),d=m(c,N.sub(k,A),p,S),E=m(R,N.sub(T,M),p,S),y=m(N.add(c,v),A,p,S),z=m(N.sub(V,c),N.add(M,k),p,S),D=m(N.sub(v,R),N.add(T,A),p,S),F=N.add(q,E);F.sub(y),F.add(D);let $=N.add(d,y),j=N.add(f,E),K=N.sub(q,f);K.add(d),K.add(z);let P=N.zeros(2*F.rows,2*F.columns);return P=P.setSubMatrix(F,0,0),P=P.setSubMatrix($,F.rows,0),P=P.setSubMatrix(j,0,F.columns),P=P.setSubMatrix(K,F.rows,F.columns),P.subMatrix(0,b-1,0,g-1)}return m(t,e,l,u)}scaleRows(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let s=new x(this.rows,this.columns);for(let o=0;o<this.rows;o++){const i=this.getRow(o);i.length>0&&dt(i,{min:t,max:r,output:i}),s.setRow(o,i)}return s}scaleColumns(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let s=new x(this.rows,this.columns);for(let o=0;o<this.columns;o++){const i=this.getColumn(o);i.length&&dt(i,{min:t,max:r,output:i}),s.setColumn(o,i)}return s}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let r=0;r<e;r++){let s=this.get(t,r),o=this.get(t,this.columns-1-r);this.set(t,r,o),this.set(t,this.columns-1-r,s)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let r=0;r<e;r++){let s=this.get(r,t),o=this.get(this.rows-1-r,t);this.set(r,t,o),this.set(this.rows-1-r,t,s)}return this}kroneckerProduct(e){e=x.checkMatrix(e);let t=this.rows,r=this.columns,s=e.rows,o=e.columns,i=new x(t*s,r*o);for(let h=0;h<t;h++)for(let l=0;l<r;l++)for(let u=0;u<s;u++)for(let m=0;m<o;m++)i.set(s*h+u,o*l+m,this.get(h,l)*e.get(u,m));return i}kroneckerSum(e){if(e=x.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,r=e.rows,s=this.kroneckerProduct(x.eye(r,r)),o=x.eye(t,t).kroneckerProduct(e);return s.add(o)}transpose(){let e=new x(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.set(r,t,this.get(t,r));return e}sortRows(e=xt){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=xt){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,r,s){gt(this,e,t,r,s);let o=new x(t-e+1,s-r+1);for(let i=e;i<=t;i++)for(let h=r;h<=s;h++)o.set(i-e,h-r,this.get(i,h));return o}subMatrixRow(e,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.columns-1),t>r||t<0||t>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let s=new x(e.length,r-t+1);for(let o=0;o<e.length;o++)for(let i=t;i<=r;i++){if(e[o]<0||e[o]>=this.rows)throw new RangeError(`Row index out of range: ${e[o]}`);s.set(o,i-t,this.get(e[o],i))}return s}subMatrixColumn(e,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.rows-1),t>r||t<0||t>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let s=new x(r-t+1,e.length);for(let o=0;o<e.length;o++)for(let i=t;i<=r;i++){if(e[o]<0||e[o]>=this.columns)throw new RangeError(`Column index out of range: ${e[o]}`);s.set(i-t,o,this.get(i,e[o]))}return s}setSubMatrix(e,t,r){if(e=x.checkMatrix(e),e.isEmpty())return this;let s=t+e.rows-1,o=r+e.columns-1;gt(this,t,s,r,o);for(let i=0;i<e.rows;i++)for(let h=0;h<e.columns;h++)this.set(t+i,r+h,e.get(i,h));return this}selection(e,t){ft(this,e),mt(this,t);let r=new x(e.length,t.length);for(let s=0;s<e.length;s++){let o=e[s];for(let i=0;i<t.length;i++){let h=t[i];r.set(s,i,this.get(o,h))}}return r}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let r=0;r<e;r++)t+=this.get(r,r);return t}clone(){return this.constructor.copy(this,new x(this.rows,this.columns))}static copy(e,t){for(const[r,s,o]of e.entries())t.set(r,s,o);return t}sum(e){switch(e){case"row":return Bt(this);case"column":return Jt(this);case void 0:return Kt(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return Gt(this);case"column":return Xt(this);case void 0:return Zt(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":{for(let r=0;r<this.rows;r++)t[r]/=this.columns;return t}case"column":{for(let r=0;r<this.columns;r++)t[r]/=this.rows;return t}case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:r=!0,mean:s=this.mean(e)}=t;if(typeof r!="boolean")throw new TypeError("unbiased must be a boolean");switch(e){case"row":{if(!O.isAnyArray(s))throw new TypeError("mean must be an array");return Ht(this,r,s)}case"column":{if(!O.isAnyArray(s))throw new TypeError("mean must be an array");return _t(this,r,s)}case void 0:{if(typeof s!="number")throw new TypeError("mean must be a number");return tr(this,r,s)}default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){typeof e=="object"&&(t=e,e=void 0);const r=this.variance(e,t);if(e===void 0)return Math.sqrt(r);for(let s=0;s<r.length;s++)r[s]=Math.sqrt(r[s]);return r}center(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:r=this.mean(e)}=t;switch(e){case"row":{if(!O.isAnyArray(r))throw new TypeError("center must be an array");return rr(this,r),this}case"column":{if(!O.isAnyArray(r))throw new TypeError("center must be an array");return er(this,r),this}case void 0:{if(typeof r!="number")throw new TypeError("center must be a number");return sr(this,r),this}default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");let r=t.scale;switch(e){case"row":{if(r===void 0)r=or(this);else if(!O.isAnyArray(r))throw new TypeError("scale must be an array");return nr(this,r),this}case"column":{if(r===void 0)r=ir(this);else if(!O.isAnyArray(r))throw new TypeError("scale must be an array");return hr(this,r),this}case void 0:{if(r===void 0)r=lr(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return ur(this,r),this}default:throw new Error(`invalid option: ${e}`)}}toString(e){return Mt(this,e)}[Symbol.iterator](){return this.entries()}*entries(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield[e,t,this.get(e,t)]}*values(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield this.get(e,t)}}N.prototype.klass="Matrix",typeof Symbol<"u"&&(N.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ot);function xt(n,e){return n-e}function ar(n){return n.every(e=>typeof e=="number")}N.random=N.rand,N.randomInt=N.randInt,N.diagonal=N.diag,N.prototype.diagonal=N.prototype.diag,N.identity=N.eye,N.prototype.negate=N.prototype.neg,N.prototype.tensorProduct=N.prototype.kroneckerProduct;class x extends N{data;#t(e,t){if(this.data=[],Number.isInteger(t)&&t>=0)for(let r=0;r<e;r++)this.data.push(new Float64Array(t));else throw new TypeError("nColumns must be a positive integer");this.rows=e,this.columns=t}constructor(e,t){if(super(),x.isMatrix(e))this.#t(e.rows,e.columns),x.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,t);else if(O.isAnyArray(e)){const r=e;if(e=r.length,t=e?r[0].length:0,typeof t!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<e;s++){if(r[s].length!==t)throw new RangeError("Inconsistent array dimensions");if(!ar(r[s]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[s]))}this.rows=e,this.columns=t}else throw new TypeError("First argument must be a positive number or an array")}set(e,t,r){return this.data[e][t]=r,this}get(e,t){return this.data[e][t]}removeRow(e){return B(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return t===void 0&&(t=e,e=this.rows),B(this,e,!0),t=Float64Array.from(tt(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){J(this,e);for(let t=0;t<this.rows;t++){const r=new Float64Array(this.columns-1);for(let s=0;s<e;s++)r[s]=this.data[t][s];for(let s=e+1;s<this.columns;s++)r[s-1]=this.data[t][s];this.data[t]=r}return this.columns-=1,this}addColumn(e,t){typeof t>"u"&&(t=e,e=this.columns),J(this,e,!0),t=rt(this,t);for(let r=0;r<this.rows;r++){const s=new Float64Array(this.columns+1);let o=0;for(;o<e;o++)s[o]=this.data[r][o];for(s[o++]=t[r];o<this.columns+1;o++)s[o]=this.data[r][o-1];this.data[r]=s}return this.columns+=1,this}}Yt(N,x);class _ extends N{#t;get size(){return this.#t.size}get rows(){return this.#t.rows}get columns(){return this.#t.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(e){return x.isMatrix(e)&&e.klassType==="SymmetricMatrix"}static zeros(e){return new this(e)}static ones(e){return new this(e).fill(1)}constructor(e){if(super(),x.isMatrix(e)){if(!e.isSymmetric())throw new TypeError("not symmetric data");this.#t=x.copy(e,new x(e.rows,e.rows))}else if(Number.isInteger(e)&&e>=0)this.#t=new x(e,e);else if(this.#t=new x(e),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const e=new _(this.diagonalSize);for(const[t,r,s]of this.upperRightEntries())e.set(t,r,s);return e}toMatrix(){return new x(this)}get(e,t){return this.#t.get(e,t)}set(e,t,r){return this.#t.set(e,t,r),this.#t.set(t,e,r),this}removeCross(e){return this.#t.removeRow(e),this.#t.removeColumn(e),this}addCross(e,t){t===void 0&&(t=e,e=this.diagonalSize);const r=t.slice();return r.splice(e,1),this.#t.addRow(e,r),this.#t.addColumn(e,t),this}applyMask(e){if(e.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const t=[];for(const[r,s]of e.entries())s||t.push(r);t.reverse();for(const r of t)this.removeCross(r);return this}toCompact(){const{diagonalSize:e}=this,t=new Array(e*(e+1)/2);for(let r=0,s=0,o=0;o<t.length;o++)t[o]=this.get(s,r),++r>=e&&(r=++s);return t}static fromCompact(e){const t=e.length,r=(Math.sqrt(8*t+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(e)}`);const s=new _(r);for(let o=0,i=0,h=0;h<t;h++)s.set(o,i,e[h]),++o>=r&&(o=++i);return s}*upperRightEntries(){for(let e=0,t=0;e<this.diagonalSize;void 0){const r=this.get(e,t);yield[e,t,r],++t>=this.diagonalSize&&(t=++e)}}*upperRightValues(){for(let e=0,t=0;e<this.diagonalSize;void 0)yield this.get(e,t),++t>=this.diagonalSize&&(t=++e)}}_.prototype.klassType="SymmetricMatrix";class ct extends _{static isDistanceMatrix(e){return _.isSymmetricMatrix(e)&&e.klassSubType==="DistanceMatrix"}constructor(e){if(super(e),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(e,t,r){return e===t&&(r=0),super.set(e,t,r)}addCross(e,t){return t===void 0&&(t=e,e=this.diagonalSize),t=t.slice(),t[e]=0,super.addCross(e,t)}toSymmetricMatrix(){return new _(this)}clone(){const e=new ct(this.diagonalSize);for(const[t,r,s]of this.upperRightEntries())t!==r&&e.set(t,r,s);return e}toCompact(){const{diagonalSize:e}=this,t=(e-1)*e/2,r=new Array(t);for(let s=1,o=0,i=0;i<r.length;i++)r[i]=this.get(o,s),++s>=e&&(s=++o+1);return r}static fromCompact(e){const t=e.length;if(t===0)return new this(0);const r=(Math.sqrt(8*t+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(e)}`);const s=new this(r);for(let o=1,i=0,h=0;h<t;h++)s.set(o,i,e[h]),++o>=r&&(o=++i+1);return s}}ct.prototype.klassSubType="DistanceMatrix";class Z extends N{constructor(e,t,r){super(),this.matrix=e,this.rows=t,this.columns=r}}class cr extends Z{constructor(e,t){J(e,t),super(e,e.rows,1),this.column=t}set(e,t,r){return this.matrix.set(e,this.column,r),this}get(e){return this.matrix.get(e,this.column)}}class fr extends Z{constructor(e,t){mt(e,t),super(e,e.rows,t.length),this.columnIndices=t}set(e,t,r){return this.matrix.set(e,this.columnIndices[t],r),this}get(e,t){return this.matrix.get(e,this.columnIndices[t])}}class mr extends Z{constructor(e){super(e,e.rows,e.columns)}set(e,t,r){return this.matrix.set(e,this.columns-t-1,r),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}class gr extends Z{constructor(e){super(e,e.rows,e.columns)}set(e,t,r){return this.matrix.set(this.rows-e-1,t,r),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}class wr extends Z{constructor(e,t){B(e,t),super(e,1,e.columns),this.row=t}set(e,t,r){return this.matrix.set(this.row,t,r),this}get(e,t){return this.matrix.get(this.row,t)}}class pr extends Z{constructor(e,t){ft(e,t),super(e,t.length,e.columns),this.rowIndices=t}set(e,t,r){return this.matrix.set(this.rowIndices[e],t,r),this}get(e,t){return this.matrix.get(this.rowIndices[e],t)}}class ht extends Z{constructor(e,t,r){ft(e,t),mt(e,r),super(e,t.length,r.length),this.rowIndices=t,this.columnIndices=r}set(e,t,r){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],r),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}class dr extends Z{constructor(e,t,r,s,o){gt(e,t,r,s,o),super(e,r-t+1,o-s+1),this.startRow=t,this.startColumn=s}set(e,t,r){return this.matrix.set(this.startRow+e,this.startColumn+t,r),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}class yr extends Z{constructor(e){super(e,e.columns,e.rows)}set(e,t,r){return this.matrix.set(t,e,r),this}get(e,t){return this.matrix.get(t,e)}}class St extends N{constructor(e,t={}){const{rows:r=1}=t;if(e.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=e.length/r,this.data=e}set(e,t,r){let s=this._calculateIndex(e,t);return this.data[s]=r,this}get(e,t){let r=this._calculateIndex(e,t);return this.data[r]}_calculateIndex(e,t){return e*this.columns+t}}class Y extends N{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,r){return this.data[e][t]=r,this}get(e,t){return this.data[e][t]}}function Mr(n,e){if(O.isAnyArray(n))return n[0]&&O.isAnyArray(n[0])?new Y(n):new St(n,e);throw new Error("the argument is not an array")}class lt{constructor(e){e=Y.checkMatrix(e);let t=e.clone(),r=t.rows,s=t.columns,o=new Float64Array(r),i=1,h,l,u,m,a,w,b,g,p;for(h=0;h<r;h++)o[h]=h;for(g=new Float64Array(r),l=0;l<s;l++){for(h=0;h<r;h++)g[h]=t.get(h,l);for(h=0;h<r;h++){for(p=Math.min(h,l),a=0,u=0;u<p;u++)a+=t.get(h,u)*g[u];g[h]-=a,t.set(h,l,g[h])}for(m=l,h=l+1;h<r;h++)Math.abs(g[h])>Math.abs(g[m])&&(m=h);if(m!==l){for(u=0;u<s;u++)w=t.get(m,u),t.set(m,u,t.get(l,u)),t.set(l,u,w);b=o[m],o[m]=o[l],o[l]=b,i=-i}if(l<r&&t.get(l,l)!==0)for(h=l+1;h<r;h++)t.set(h,l,t.get(h,l)/t.get(l,l))}this.LU=t,this.pivotVector=o,this.pivotSign=i}isSingular(){let e=this.LU,t=e.columns;for(let r=0;r<t;r++)if(e.get(r,r)===0)return!0;return!1}solve(e){e=x.checkMatrix(e);let t=this.LU;if(t.rows!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r=e.columns,s=e.subMatrixRow(this.pivotVector,0,r-1),o=t.columns,i,h,l;for(l=0;l<o;l++)for(i=l+1;i<o;i++)for(h=0;h<r;h++)s.set(i,h,s.get(i,h)-s.get(l,h)*t.get(i,l));for(l=o-1;l>=0;l--){for(h=0;h<r;h++)s.set(l,h,s.get(l,h)/t.get(l,l));for(i=0;i<l;i++)for(h=0;h<r;h++)s.set(i,h,s.get(i,h)-s.get(l,h)*t.get(i,l))}return s}get determinant(){let e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");let t=this.pivotSign,r=e.columns;for(let s=0;s<r;s++)t*=e.get(s,s);return t}get lowerTriangularMatrix(){let e=this.LU,t=e.rows,r=e.columns,s=new x(t,r);for(let o=0;o<t;o++)for(let i=0;i<r;i++)o>i?s.set(o,i,e.get(o,i)):o===i?s.set(o,i,1):s.set(o,i,0);return s}get upperTriangularMatrix(){let e=this.LU,t=e.rows,r=e.columns,s=new x(t,r);for(let o=0;o<t;o++)for(let i=0;i<r;i++)o<=i?s.set(o,i,e.get(o,i)):s.set(o,i,0);return s}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function H(n,e){let t=0;return Math.abs(n)>Math.abs(e)?(t=e/n,Math.abs(n)*Math.sqrt(1+t*t)):e!==0?(t=n/e,Math.abs(e)*Math.sqrt(1+t*t)):0}class wt{constructor(e){e=Y.checkMatrix(e);let t=e.clone(),r=e.rows,s=e.columns,o=new Float64Array(s),i,h,l,u;for(l=0;l<s;l++){let m=0;for(i=l;i<r;i++)m=H(m,t.get(i,l));if(m!==0){for(t.get(l,l)<0&&(m=-m),i=l;i<r;i++)t.set(i,l,t.get(i,l)/m);for(t.set(l,l,t.get(l,l)+1),h=l+1;h<s;h++){for(u=0,i=l;i<r;i++)u+=t.get(i,l)*t.get(i,h);for(u=-u/t.get(l,l),i=l;i<r;i++)t.set(i,h,t.get(i,h)+u*t.get(i,l))}}o[l]=-m}this.QR=t,this.Rdiag=o}solve(e){e=x.checkMatrix(e);let t=this.QR,r=t.rows;if(e.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let s=e.columns,o=e.clone(),i=t.columns,h,l,u,m;for(u=0;u<i;u++)for(l=0;l<s;l++){for(m=0,h=u;h<r;h++)m+=t.get(h,u)*o.get(h,l);for(m=-m/t.get(u,u),h=u;h<r;h++)o.set(h,l,o.get(h,l)+m*t.get(h,u))}for(u=i-1;u>=0;u--){for(l=0;l<s;l++)o.set(u,l,o.get(u,l)/this.Rdiag[u]);for(h=0;h<u;h++)for(l=0;l<s;l++)o.set(h,l,o.get(h,l)-o.get(u,l)*t.get(h,u))}return o.subMatrix(0,i-1,0,s-1)}isFullRank(){let e=this.QR.columns;for(let t=0;t<e;t++)if(this.Rdiag[t]===0)return!1;return!0}get upperTriangularMatrix(){let e=this.QR,t=e.columns,r=new x(t,t),s,o;for(s=0;s<t;s++)for(o=0;o<t;o++)s<o?r.set(s,o,e.get(s,o)):s===o?r.set(s,o,this.Rdiag[s]):r.set(s,o,0);return r}get orthogonalMatrix(){let e=this.QR,t=e.rows,r=e.columns,s=new x(t,r),o,i,h,l;for(h=r-1;h>=0;h--){for(o=0;o<t;o++)s.set(o,h,0);for(s.set(h,h,1),i=h;i<r;i++)if(e.get(h,h)!==0){for(l=0,o=h;o<t;o++)l+=e.get(o,h)*s.get(o,i);for(l=-l/e.get(h,h),o=h;o<t;o++)s.set(o,i,s.get(o,i)+l*e.get(o,h))}}return s}}class st{constructor(e,t={}){if(e=Y.checkMatrix(e),e.isEmpty())throw new Error("Matrix must be non-empty");let r=e.rows,s=e.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:h=!1}=t;let l=!!o,u=!!i,m=!1,a;if(r<s)if(!h)a=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{a=e.transpose(),r=a.rows,s=a.columns,m=!0;let f=l;l=u,u=f}else a=e.clone();let w=Math.min(r,s),b=Math.min(r+1,s),g=new Float64Array(b),p=new x(r,w),S=new x(s,s),c=new Float64Array(s),M=new Float64Array(r),v=new Float64Array(b);for(let f=0;f<b;f++)v[f]=f;let k=Math.min(r-1,s),V=Math.max(0,Math.min(s-2,r)),T=Math.max(k,V);for(let f=0;f<T;f++){if(f<k){g[f]=0;for(let d=f;d<r;d++)g[f]=H(g[f],a.get(d,f));if(g[f]!==0){a.get(f,f)<0&&(g[f]=-g[f]);for(let d=f;d<r;d++)a.set(d,f,a.get(d,f)/g[f]);a.set(f,f,a.get(f,f)+1)}g[f]=-g[f]}for(let d=f+1;d<s;d++){if(f<k&&g[f]!==0){let E=0;for(let y=f;y<r;y++)E+=a.get(y,f)*a.get(y,d);E=-E/a.get(f,f);for(let y=f;y<r;y++)a.set(y,d,a.get(y,d)+E*a.get(y,f))}c[d]=a.get(f,d)}if(l&&f<k)for(let d=f;d<r;d++)p.set(d,f,a.get(d,f));if(f<V){c[f]=0;for(let d=f+1;d<s;d++)c[f]=H(c[f],c[d]);if(c[f]!==0){c[f+1]<0&&(c[f]=0-c[f]);for(let d=f+1;d<s;d++)c[d]/=c[f];c[f+1]+=1}if(c[f]=-c[f],f+1<r&&c[f]!==0){for(let d=f+1;d<r;d++)M[d]=0;for(let d=f+1;d<r;d++)for(let E=f+1;E<s;E++)M[d]+=c[E]*a.get(d,E);for(let d=f+1;d<s;d++){let E=-c[d]/c[f+1];for(let y=f+1;y<r;y++)a.set(y,d,a.get(y,d)+E*M[y])}}if(u)for(let d=f+1;d<s;d++)S.set(d,f,c[d])}}let R=Math.min(s,r+1);if(k<s&&(g[k]=a.get(k,k)),r<R&&(g[R-1]=0),V+1<R&&(c[V]=a.get(V,R-1)),c[R-1]=0,l){for(let f=k;f<w;f++){for(let d=0;d<r;d++)p.set(d,f,0);p.set(f,f,1)}for(let f=k-1;f>=0;f--)if(g[f]!==0){for(let d=f+1;d<w;d++){let E=0;for(let y=f;y<r;y++)E+=p.get(y,f)*p.get(y,d);E=-E/p.get(f,f);for(let y=f;y<r;y++)p.set(y,d,p.get(y,d)+E*p.get(y,f))}for(let d=f;d<r;d++)p.set(d,f,-p.get(d,f));p.set(f,f,1+p.get(f,f));for(let d=0;d<f-1;d++)p.set(d,f,0)}else{for(let d=0;d<r;d++)p.set(d,f,0);p.set(f,f,1)}}if(u)for(let f=s-1;f>=0;f--){if(f<V&&c[f]!==0)for(let d=f+1;d<s;d++){let E=0;for(let y=f+1;y<s;y++)E+=S.get(y,f)*S.get(y,d);E=-E/S.get(f+1,f);for(let y=f+1;y<s;y++)S.set(y,d,S.get(y,d)+E*S.get(y,f))}for(let d=0;d<s;d++)S.set(d,f,0);S.set(f,f,1)}let A=R-1,q=Number.EPSILON;for(;R>0;){let f,d;for(f=R-2;f>=-1&&f!==-1;f--){const E=Number.MIN_VALUE+q*Math.abs(g[f]+Math.abs(g[f+1]));if(Math.abs(c[f])<=E||Number.isNaN(c[f])){c[f]=0;break}}if(f===R-2)d=4;else{let E;for(E=R-1;E>=f&&E!==f;E--){let y=(E!==R?Math.abs(c[E]):0)+(E!==f+1?Math.abs(c[E-1]):0);if(Math.abs(g[E])<=q*y){g[E]=0;break}}E===f?d=3:E===R-1?d=1:(d=2,f=E)}switch(f++,d){case 1:{let E=c[R-2];c[R-2]=0;for(let y=R-2;y>=f;y--){let z=H(g[y],E),D=g[y]/z,F=E/z;if(g[y]=z,y!==f&&(E=-F*c[y-1],c[y-1]=D*c[y-1]),u)for(let $=0;$<s;$++)z=D*S.get($,y)+F*S.get($,R-1),S.set($,R-1,-F*S.get($,y)+D*S.get($,R-1)),S.set($,y,z)}break}case 2:{let E=c[f-1];c[f-1]=0;for(let y=f;y<R;y++){let z=H(g[y],E),D=g[y]/z,F=E/z;if(g[y]=z,E=-F*c[y],c[y]=D*c[y],l)for(let $=0;$<r;$++)z=D*p.get($,y)+F*p.get($,f-1),p.set($,f-1,-F*p.get($,y)+D*p.get($,f-1)),p.set($,y,z)}break}case 3:{const E=Math.max(Math.abs(g[R-1]),Math.abs(g[R-2]),Math.abs(c[R-2]),Math.abs(g[f]),Math.abs(c[f])),y=g[R-1]/E,z=g[R-2]/E,D=c[R-2]/E,F=g[f]/E,$=c[f]/E,j=((z+y)*(z-y)+D*D)/2,K=y*D*(y*D);let P=0;(j!==0||K!==0)&&(j<0?P=0-Math.sqrt(j*j+K):P=Math.sqrt(j*j+K),P=K/(j+P));let G=(F+y)*(F-y)+P,X=F*$;for(let C=f;C<R-1;C++){let U=H(G,X);U===0&&(U=Number.MIN_VALUE);let Q=G/U,W=X/U;if(C!==f&&(c[C-1]=U),G=Q*g[C]+W*c[C],c[C]=Q*c[C]-W*g[C],X=W*g[C+1],g[C+1]=Q*g[C+1],u)for(let L=0;L<s;L++)U=Q*S.get(L,C)+W*S.get(L,C+1),S.set(L,C+1,-W*S.get(L,C)+Q*S.get(L,C+1)),S.set(L,C,U);if(U=H(G,X),U===0&&(U=Number.MIN_VALUE),Q=G/U,W=X/U,g[C]=U,G=Q*c[C]+W*g[C+1],g[C+1]=-W*c[C]+Q*g[C+1],X=W*c[C+1],c[C+1]=Q*c[C+1],l&&C<r-1)for(let L=0;L<r;L++)U=Q*p.get(L,C)+W*p.get(L,C+1),p.set(L,C+1,-W*p.get(L,C)+Q*p.get(L,C+1)),p.set(L,C,U)}c[R-2]=G;break}case 4:{if(g[f]<=0&&(g[f]=g[f]<0?-g[f]:0,u))for(let E=0;E<=A;E++)S.set(E,f,-S.get(E,f));for(;f<A&&!(g[f]>=g[f+1]);){let E=g[f];if(g[f]=g[f+1],g[f+1]=E,u&&f<s-1)for(let y=0;y<s;y++)E=S.get(y,f+1),S.set(y,f+1,S.get(y,f)),S.set(y,f,E);if(l&&f<r-1)for(let y=0;y<r;y++)E=p.get(y,f+1),p.set(y,f+1,p.get(y,f)),p.set(y,f,E);f++}R--;break}}}if(m){let f=S;S=p,p=f}this.m=r,this.n=s,this.s=g,this.U=p,this.V=S}solve(e){let t=e,r=this.threshold,s=this.s.length,o=x.zeros(s,s);for(let w=0;w<s;w++)Math.abs(this.s[w])<=r?o.set(w,w,0):o.set(w,w,1/this.s[w]);let i=this.U,h=this.rightSingularVectors,l=h.mmul(o),u=h.rows,m=i.rows,a=x.zeros(u,m);for(let w=0;w<u;w++)for(let b=0;b<m;b++){let g=0;for(let p=0;p<s;p++)g+=l.get(w,p)*i.get(b,p);a.set(w,b,g)}return a.mmul(t)}solveForDiagonal(e){return this.solve(x.diag(e))}inverse(){let e=this.V,t=this.threshold,r=e.rows,s=e.columns,o=new x(r,this.s.length);for(let m=0;m<r;m++)for(let a=0;a<s;a++)Math.abs(this.s[a])>t&&o.set(m,a,e.get(m,a)/this.s[a]);let i=this.U,h=i.rows,l=i.columns,u=new x(r,h);for(let m=0;m<r;m++)for(let a=0;a<h;a++){let w=0;for(let b=0;b<l;b++)w+=o.get(m,b)*i.get(a,b);u.set(m,a,w)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,r=this.s;for(let s=0,o=r.length;s<o;s++)r[s]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function br(n,e=!1){return n=Y.checkMatrix(n),e?new st(n).inverse():Et(n,x.eye(n.rows))}function Et(n,e,t=!1){return n=Y.checkMatrix(n),e=Y.checkMatrix(e),t?new st(n).solve(e):n.isSquare()?new lt(n).solve(e):new wt(n).solve(e)}function ut(n){if(n=x.checkMatrix(n),n.isSquare()){if(n.columns===0)return 1;let e,t,r,s;if(n.columns===2)return e=n.get(0,0),t=n.get(0,1),r=n.get(1,0),s=n.get(1,1),e*s-t*r;if(n.columns===3){let o,i,h;return o=new ht(n,[1,2],[1,2]),i=new ht(n,[1,2],[0,2]),h=new ht(n,[1,2],[0,1]),e=n.get(0,0),t=n.get(0,1),r=n.get(0,2),e*ut(o)-t*ut(i)+r*ut(h)}else return new lt(n).determinant}else throw Error("determinant can only be calculated for a square matrix")}function xr(n,e){let t=[];for(let r=0;r<n;r++)r!==e&&t.push(r);return t}function Sr(n,e,t,r=1e-9,s=1e-9){if(n>s)return new Array(e.rows+1).fill(0);{let o=e.addRow(t,[0]);for(let i=0;i<o.rows;i++)Math.abs(o.get(i,0))<r&&o.set(i,0,0);return o.to1DArray()}}function Er(n,e={}){const{thresholdValue:t=1e-9,thresholdError:r=1e-9}=e;n=x.checkMatrix(n);let s=n.rows,o=new x(s,s);for(let i=0;i<s;i++){let h=x.columnVector(n.getRow(i)),l=n.subMatrixRow(xr(s,i)).transpose(),u=new st(l).solve(h),m=x.sub(h,l.mmul(u)).abs().max();o.setRow(i,Sr(m,u,i,t,r))}return o}function vr(n,e=Number.EPSILON){if(n=x.checkMatrix(n),n.isEmpty())return n.transpose();let t=new st(n,{autoTranspose:!0}),r=t.leftSingularVectors,s=t.rightSingularVectors,o=t.diagonal;for(let i=0;i<o.length;i++)Math.abs(o[i])>e?o[i]=1/o[i]:o[i]=0;return s.mmul(x.diag(o).mmul(r.transpose()))}function Rr(n,e=n,t={}){n=new x(n);let r=!1;if(typeof e=="object"&&!x.isMatrix(e)&&!O.isAnyArray(e)?(t=e,e=n,r=!0):e=new x(e),n.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=t;s&&(n=n.center("column"),r||(e=e.center("column")));const o=n.transpose().mmul(e);for(let i=0;i<o.rows;i++)for(let h=0;h<o.columns;h++)o.set(i,h,o.get(i,h)*(1/(n.rows-1)));return o}function Ar(n,e=n,t={}){n=new x(n);let r=!1;if(typeof e=="object"&&!x.isMatrix(e)&&!O.isAnyArray(e)?(t=e,e=n,r=!0):e=new x(e),n.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=t;s&&(n.center("column"),r||e.center("column")),o&&(n.scale("column"),r||e.scale("column"));const i=n.standardDeviation("column",{unbiased:!0}),h=r?i:e.standardDeviation("column",{unbiased:!0}),l=n.transpose().mmul(e);for(let u=0;u<l.rows;u++)for(let m=0;m<l.columns;m++)l.set(u,m,l.get(u,m)*(1/(i[u]*h[m]))*(1/(n.rows-1)));return l}class vt{constructor(e,t={}){const{assumeSymmetric:r=!1}=t;if(e=Y.checkMatrix(e),!e.isSquare())throw new Error("Matrix is not a square matrix");if(e.isEmpty())throw new Error("Matrix must be non-empty");let s=e.columns,o=new x(s,s),i=new Float64Array(s),h=new Float64Array(s),l=e,u,m,a=!1;if(r?a=!0:a=e.isSymmetric(),a){for(u=0;u<s;u++)for(m=0;m<s;m++)o.set(u,m,l.get(u,m));kr(s,h,i,o),Vr(s,h,i,o)}else{let w=new x(s,s),b=new Float64Array(s);for(m=0;m<s;m++)for(u=0;u<s;u++)w.set(u,m,l.get(u,m));Nr(s,w,b,o),Ir(s,h,i,o,w)}this.n=s,this.e=h,this.d=i,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let e=this.n,t=this.e,r=this.d,s=new x(e,e),o,i;for(o=0;o<e;o++){for(i=0;i<e;i++)s.set(o,i,0);s.set(o,o,r[o]),t[o]>0?s.set(o,o+1,t[o]):t[o]<0&&s.set(o,o-1,t[o])}return s}}function kr(n,e,t,r){let s,o,i,h,l,u,m,a;for(l=0;l<n;l++)t[l]=r.get(n-1,l);for(h=n-1;h>0;h--){for(a=0,i=0,u=0;u<h;u++)a=a+Math.abs(t[u]);if(a===0)for(e[h]=t[h-1],l=0;l<h;l++)t[l]=r.get(h-1,l),r.set(h,l,0),r.set(l,h,0);else{for(u=0;u<h;u++)t[u]/=a,i+=t[u]*t[u];for(s=t[h-1],o=Math.sqrt(i),s>0&&(o=-o),e[h]=a*o,i=i-s*o,t[h-1]=s-o,l=0;l<h;l++)e[l]=0;for(l=0;l<h;l++){for(s=t[l],r.set(l,h,s),o=e[l]+r.get(l,l)*s,u=l+1;u<=h-1;u++)o+=r.get(u,l)*t[u],e[u]+=r.get(u,l)*s;e[l]=o}for(s=0,l=0;l<h;l++)e[l]/=i,s+=e[l]*t[l];for(m=s/(i+i),l=0;l<h;l++)e[l]-=m*t[l];for(l=0;l<h;l++){for(s=t[l],o=e[l],u=l;u<=h-1;u++)r.set(u,l,r.get(u,l)-(s*e[u]+o*t[u]));t[l]=r.get(h-1,l),r.set(h,l,0)}}t[h]=i}for(h=0;h<n-1;h++){if(r.set(n-1,h,r.get(h,h)),r.set(h,h,1),i=t[h+1],i!==0){for(u=0;u<=h;u++)t[u]=r.get(u,h+1)/i;for(l=0;l<=h;l++){for(o=0,u=0;u<=h;u++)o+=r.get(u,h+1)*r.get(u,l);for(u=0;u<=h;u++)r.set(u,l,r.get(u,l)-o*t[u])}}for(u=0;u<=h;u++)r.set(u,h+1,0)}for(l=0;l<n;l++)t[l]=r.get(n-1,l),r.set(n-1,l,0);r.set(n-1,n-1,1),e[0]=0}function Vr(n,e,t,r){let s,o,i,h,l,u,m,a,w,b,g,p,S,c,M,v;for(i=1;i<n;i++)e[i-1]=e[i];e[n-1]=0;let k=0,V=0,T=Number.EPSILON;for(u=0;u<n;u++){for(V=Math.max(V,Math.abs(t[u])+Math.abs(e[u])),m=u;m<n&&!(Math.abs(e[m])<=T*V);)m++;if(m>u)do{for(s=t[u],a=(t[u+1]-s)/(2*e[u]),w=H(a,1),a<0&&(w=-w),t[u]=e[u]/(a+w),t[u+1]=e[u]*(a+w),b=t[u+1],o=s-t[u],i=u+2;i<n;i++)t[i]-=o;for(k=k+o,a=t[m],g=1,p=g,S=g,c=e[u+1],M=0,v=0,i=m-1;i>=u;i--)for(S=p,p=g,v=M,s=g*e[i],o=g*a,w=H(a,e[i]),e[i+1]=M*w,M=e[i]/w,g=a/w,a=g*t[i]-M*s,t[i+1]=o+M*(g*s+M*t[i]),l=0;l<n;l++)o=r.get(l,i+1),r.set(l,i+1,M*r.get(l,i)+g*o),r.set(l,i,g*r.get(l,i)-M*o);a=-M*v*S*c*e[u]/b,e[u]=M*a,t[u]=g*a}while(Math.abs(e[u])>T*V);t[u]=t[u]+k,e[u]=0}for(i=0;i<n-1;i++){for(l=i,a=t[i],h=i+1;h<n;h++)t[h]<a&&(l=h,a=t[h]);if(l!==i)for(t[l]=t[i],t[i]=a,h=0;h<n;h++)a=r.get(h,i),r.set(h,i,r.get(h,l)),r.set(h,l,a)}}function Nr(n,e,t,r){let s=0,o=n-1,i,h,l,u,m,a,w;for(a=s+1;a<=o-1;a++){for(w=0,u=a;u<=o;u++)w=w+Math.abs(e.get(u,a-1));if(w!==0){for(l=0,u=o;u>=a;u--)t[u]=e.get(u,a-1)/w,l+=t[u]*t[u];for(h=Math.sqrt(l),t[a]>0&&(h=-h),l=l-t[a]*h,t[a]=t[a]-h,m=a;m<n;m++){for(i=0,u=o;u>=a;u--)i+=t[u]*e.get(u,m);for(i=i/l,u=a;u<=o;u++)e.set(u,m,e.get(u,m)-i*t[u])}for(u=0;u<=o;u++){for(i=0,m=o;m>=a;m--)i+=t[m]*e.get(u,m);for(i=i/l,m=a;m<=o;m++)e.set(u,m,e.get(u,m)-i*t[m])}t[a]=w*t[a],e.set(a,a-1,w*h)}}for(u=0;u<n;u++)for(m=0;m<n;m++)r.set(u,m,u===m?1:0);for(a=o-1;a>=s+1;a--)if(e.get(a,a-1)!==0){for(u=a+1;u<=o;u++)t[u]=e.get(u,a-1);for(m=a;m<=o;m++){for(h=0,u=a;u<=o;u++)h+=t[u]*r.get(u,m);for(h=h/t[a]/e.get(a,a-1),u=a;u<=o;u++)r.set(u,m,r.get(u,m)+h*t[u])}}}function Ir(n,e,t,r,s){let o=n-1,i=0,h=n-1,l=Number.EPSILON,u=0,m=0,a=0,w=0,b=0,g=0,p=0,S=0,c,M,v,k,V,T,R,A,q,f,d,E,y,z,D;for(c=0;c<n;c++)for((c<i||c>h)&&(t[c]=s.get(c,c),e[c]=0),M=Math.max(c-1,0);M<n;M++)m=m+Math.abs(s.get(c,M));for(;o>=i;){for(k=o;k>i&&(g=Math.abs(s.get(k-1,k-1))+Math.abs(s.get(k,k)),g===0&&(g=m),!(Math.abs(s.get(k,k-1))<l*g));)k--;if(k===o)s.set(o,o,s.get(o,o)+u),t[o]=s.get(o,o),e[o]=0,o--,S=0;else if(k===o-1){if(R=s.get(o,o-1)*s.get(o-1,o),a=(s.get(o-1,o-1)-s.get(o,o))/2,w=a*a+R,p=Math.sqrt(Math.abs(w)),s.set(o,o,s.get(o,o)+u),s.set(o-1,o-1,s.get(o-1,o-1)+u),A=s.get(o,o),w>=0){for(p=a>=0?a+p:a-p,t[o-1]=A+p,t[o]=t[o-1],p!==0&&(t[o]=A-R/p),e[o-1]=0,e[o]=0,A=s.get(o,o-1),g=Math.abs(A)+Math.abs(p),a=A/g,w=p/g,b=Math.sqrt(a*a+w*w),a=a/b,w=w/b,M=o-1;M<n;M++)p=s.get(o-1,M),s.set(o-1,M,w*p+a*s.get(o,M)),s.set(o,M,w*s.get(o,M)-a*p);for(c=0;c<=o;c++)p=s.get(c,o-1),s.set(c,o-1,w*p+a*s.get(c,o)),s.set(c,o,w*s.get(c,o)-a*p);for(c=i;c<=h;c++)p=r.get(c,o-1),r.set(c,o-1,w*p+a*r.get(c,o)),r.set(c,o,w*r.get(c,o)-a*p)}else t[o-1]=A+a,t[o]=A+a,e[o-1]=p,e[o]=-p;o=o-2,S=0}else{if(A=s.get(o,o),q=0,R=0,k<o&&(q=s.get(o-1,o-1),R=s.get(o,o-1)*s.get(o-1,o)),S===10){for(u+=A,c=i;c<=o;c++)s.set(c,c,s.get(c,c)-A);g=Math.abs(s.get(o,o-1))+Math.abs(s.get(o-1,o-2)),A=q=.75*g,R=-.4375*g*g}if(S===30&&(g=(q-A)/2,g=g*g+R,g>0)){for(g=Math.sqrt(g),q<A&&(g=-g),g=A-R/((q-A)/2+g),c=i;c<=o;c++)s.set(c,c,s.get(c,c)-g);u+=g,A=q=R=.964}for(S=S+1,V=o-2;V>=k&&(p=s.get(V,V),b=A-p,g=q-p,a=(b*g-R)/s.get(V+1,V)+s.get(V,V+1),w=s.get(V+1,V+1)-p-b-g,b=s.get(V+2,V+1),g=Math.abs(a)+Math.abs(w)+Math.abs(b),a=a/g,w=w/g,b=b/g,!(V===k||Math.abs(s.get(V,V-1))*(Math.abs(w)+Math.abs(b))<l*(Math.abs(a)*(Math.abs(s.get(V-1,V-1))+Math.abs(p)+Math.abs(s.get(V+1,V+1))))));)V--;for(c=V+2;c<=o;c++)s.set(c,c-2,0),c>V+2&&s.set(c,c-3,0);for(v=V;v<=o-1&&(z=v!==o-1,v!==V&&(a=s.get(v,v-1),w=s.get(v+1,v-1),b=z?s.get(v+2,v-1):0,A=Math.abs(a)+Math.abs(w)+Math.abs(b),A!==0&&(a=a/A,w=w/A,b=b/A)),A!==0);v++)if(g=Math.sqrt(a*a+w*w+b*b),a<0&&(g=-g),g!==0){for(v!==V?s.set(v,v-1,-g*A):k!==V&&s.set(v,v-1,-s.get(v,v-1)),a=a+g,A=a/g,q=w/g,p=b/g,w=w/a,b=b/a,M=v;M<n;M++)a=s.get(v,M)+w*s.get(v+1,M),z&&(a=a+b*s.get(v+2,M),s.set(v+2,M,s.get(v+2,M)-a*p)),s.set(v,M,s.get(v,M)-a*A),s.set(v+1,M,s.get(v+1,M)-a*q);for(c=0;c<=Math.min(o,v+3);c++)a=A*s.get(c,v)+q*s.get(c,v+1),z&&(a=a+p*s.get(c,v+2),s.set(c,v+2,s.get(c,v+2)-a*b)),s.set(c,v,s.get(c,v)-a),s.set(c,v+1,s.get(c,v+1)-a*w);for(c=i;c<=h;c++)a=A*r.get(c,v)+q*r.get(c,v+1),z&&(a=a+p*r.get(c,v+2),r.set(c,v+2,r.get(c,v+2)-a*b)),r.set(c,v,r.get(c,v)-a),r.set(c,v+1,r.get(c,v+1)-a*w)}}}if(m!==0){for(o=n-1;o>=0;o--)if(a=t[o],w=e[o],w===0)for(k=o,s.set(o,o,1),c=o-1;c>=0;c--){for(R=s.get(c,c)-a,b=0,M=k;M<=o;M++)b=b+s.get(c,M)*s.get(M,o);if(e[c]<0)p=R,g=b;else if(k=c,e[c]===0?s.set(c,o,R!==0?-b/R:-b/(l*m)):(A=s.get(c,c+1),q=s.get(c+1,c),w=(t[c]-a)*(t[c]-a)+e[c]*e[c],T=(A*g-p*b)/w,s.set(c,o,T),s.set(c+1,o,Math.abs(A)>Math.abs(p)?(-b-R*T)/A:(-g-q*T)/p)),T=Math.abs(s.get(c,o)),l*T*T>1)for(M=c;M<=o;M++)s.set(M,o,s.get(M,o)/T)}else if(w<0)for(k=o-1,Math.abs(s.get(o,o-1))>Math.abs(s.get(o-1,o))?(s.set(o-1,o-1,w/s.get(o,o-1)),s.set(o-1,o,-(s.get(o,o)-a)/s.get(o,o-1))):(D=at(0,-s.get(o-1,o),s.get(o-1,o-1)-a,w),s.set(o-1,o-1,D[0]),s.set(o-1,o,D[1])),s.set(o,o-1,0),s.set(o,o,1),c=o-2;c>=0;c--){for(f=0,d=0,M=k;M<=o;M++)f=f+s.get(c,M)*s.get(M,o-1),d=d+s.get(c,M)*s.get(M,o);if(R=s.get(c,c)-a,e[c]<0)p=R,b=f,g=d;else if(k=c,e[c]===0?(D=at(-f,-d,R,w),s.set(c,o-1,D[0]),s.set(c,o,D[1])):(A=s.get(c,c+1),q=s.get(c+1,c),E=(t[c]-a)*(t[c]-a)+e[c]*e[c]-w*w,y=(t[c]-a)*2*w,E===0&&y===0&&(E=l*m*(Math.abs(R)+Math.abs(w)+Math.abs(A)+Math.abs(q)+Math.abs(p))),D=at(A*b-p*f+w*d,A*g-p*d-w*f,E,y),s.set(c,o-1,D[0]),s.set(c,o,D[1]),Math.abs(A)>Math.abs(p)+Math.abs(w)?(s.set(c+1,o-1,(-f-R*s.get(c,o-1)+w*s.get(c,o))/A),s.set(c+1,o,(-d-R*s.get(c,o)-w*s.get(c,o-1))/A)):(D=at(-b-q*s.get(c,o-1),-g-q*s.get(c,o),p,w),s.set(c+1,o-1,D[0]),s.set(c+1,o,D[1]))),T=Math.max(Math.abs(s.get(c,o-1)),Math.abs(s.get(c,o))),l*T*T>1)for(M=c;M<=o;M++)s.set(M,o-1,s.get(M,o-1)/T),s.set(M,o,s.get(M,o)/T)}for(c=0;c<n;c++)if(c<i||c>h)for(M=c;M<n;M++)r.set(c,M,s.get(c,M));for(M=n-1;M>=i;M--)for(c=i;c<=h;c++){for(p=0,v=i;v<=Math.min(M,h);v++)p=p+r.get(c,v)*s.get(v,M);r.set(c,M,p)}}}function at(n,e,t,r){let s,o;return Math.abs(t)>Math.abs(r)?(s=r/t,o=t+s*r,[(n+s*e)/o,(e-s*n)/o]):(s=t/r,o=r+s*t,[(s*n+e)/o,(s*e-n)/o])}class Rt{constructor(e){if(e=Y.checkMatrix(e),!e.isSymmetric())throw new Error("Matrix is not symmetric");let t=e,r=t.rows,s=new x(r,r),o=!0,i,h,l;for(h=0;h<r;h++){let u=0;for(l=0;l<h;l++){let m=0;for(i=0;i<l;i++)m+=s.get(l,i)*s.get(h,i);m=(t.get(h,l)-m)/s.get(l,l),s.set(h,l,m),u=u+m*m}for(u=t.get(h,h)-u,o&=u>0,s.set(h,h,Math.sqrt(Math.max(u,0))),l=h+1;l<r;l++)s.set(h,l,0)}this.L=s,this.positiveDefinite=!!o}isPositiveDefinite(){return this.positiveDefinite}solve(e){e=Y.checkMatrix(e);let t=this.L,r=t.rows;if(e.rows!==r)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let s=e.columns,o=e.clone(),i,h,l;for(l=0;l<r;l++)for(h=0;h<s;h++){for(i=0;i<l;i++)o.set(l,h,o.get(l,h)-o.get(i,h)*t.get(l,i));o.set(l,h,o.get(l,h)/t.get(l,l))}for(l=r-1;l>=0;l--)for(h=0;h<s;h++){for(i=l+1;i<r;i++)o.set(l,h,o.get(l,h)-o.get(i,h)*t.get(i,l));o.set(l,h,o.get(l,h)/t.get(l,l))}return o}get lowerTriangularMatrix(){return this.L}}class At{constructor(e,t={}){e=Y.checkMatrix(e);let{Y:r}=t;const{scaleScores:s=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=t;let h;if(r){if(O.isAnyArray(r)&&typeof r[0]=="number"?r=x.columnVector(r):r=Y.checkMatrix(r),r.rows!==e.rows)throw new Error("Y should have the same number of rows as X");h=r.getColumnVector(0)}else h=e.getColumnVector(0);let l=1,u,m,a,w;for(let b=0;b<o&&l>i;b++)a=e.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),a=a.div(a.norm()),u=e.mmul(a).div(a.transpose().mmul(a).get(0,0)),b>0&&(l=u.clone().sub(w).pow(2).sum()),w=u.clone(),r?(m=r.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),m=m.div(m.norm()),h=r.mmul(m).div(m.transpose().mmul(m).get(0,0))):h=u;if(r){let b=e.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0));b=b.div(b.norm());let g=e.clone().sub(u.clone().mmul(b.transpose())),p=h.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),S=r.clone().sub(u.clone().mulS(p.get(0,0)).mmul(m.transpose()));this.t=u,this.p=b.transpose(),this.w=a.transpose(),this.q=m,this.u=h,this.s=u.transpose().mmul(u),this.xResidual=g,this.yResidual=S,this.betas=p}else this.w=a.transpose(),this.s=u.transpose().mmul(u).sqrt(),s?this.t=u.clone().div(this.s.get(0,0)):this.t=u,this.xResidual=e.sub(u.mmul(a.transpose()))}}var Cr=I.AbstractMatrix=N,Dr=I.CHO=Rt,qr=I.CholeskyDecomposition=Rt,Fr=I.DistanceMatrix=ct,Tr=I.EVD=vt,zr=I.EigenvalueDecomposition=vt,$r=I.LU=lt,Pr=I.LuDecomposition=lt,kt=I.Matrix=x,Lr=I.MatrixColumnSelectionView=fr,jr=I.MatrixColumnView=cr,Ur=I.MatrixFlipColumnView=mr,Or=I.MatrixFlipRowView=gr,Qr=I.MatrixRowSelectionView=pr,Wr=I.MatrixRowView=wr,Yr=I.MatrixSelectionView=ht,Br=I.MatrixSubView=dr,Jr=I.MatrixTransposeView=yr,Kr=I.NIPALS=At,Gr=I.Nipals=At,Xr=I.QR=wt,Zr=I.QrDecomposition=wt,Hr=I.SVD=st,_r=I.SingularValueDecomposition=st,te=I.SymmetricMatrix=_,re=I.WrapperMatrix1D=St,ee=I.WrapperMatrix2D=Y,se=I.correlation=Ar,oe=I.covariance=Rr,Vt=I.default=x,ne=I.determinant=ut,ie=I.inverse=br,he=I.linearDependencies=Er,le=I.pseudoInverse=vr,ue=I.solve=Et,ae=I.wrap=Mr;const ce=Cr,fe=Dr,me=qr,ge=Fr,we=Tr,pe=zr,de=$r,ye=Pr,Me=kt,be=Lr,xe=jr,Se=Ur,Ee=Or,ve=Qr,Re=Wr,Ae=Yr,ke=Br,Ve=Jr,Ne=Kr,Ie=Gr,Ce=Xr,De=Zr,qe=Hr,Fe=_r,Te=te,ze=re,$e=ee,Pe=se,Le=oe;var je=Vt.Matrix?Vt.Matrix:kt;const Ue=ne,Oe=ie,Qe=he,We=le,Ye=ue,Be=ae;export{ce as AbstractMatrix,fe as CHO,me as CholeskyDecomposition,ge as DistanceMatrix,we as EVD,pe as EigenvalueDecomposition,de as LU,ye as LuDecomposition,Me as Matrix,be as MatrixColumnSelectionView,xe as MatrixColumnView,Se as MatrixFlipColumnView,Ee as MatrixFlipRowView,ve as MatrixRowSelectionView,Re as MatrixRowView,Ae as MatrixSelectionView,ke as MatrixSubView,Ve as MatrixTransposeView,Ne as NIPALS,Ie as Nipals,Ce as QR,De as QrDecomposition,qe as SVD,Fe as SingularValueDecomposition,Te as SymmetricMatrix,ze as WrapperMatrix1D,$e as WrapperMatrix2D,Pe as correlation,Le as covariance,je as default,Ue as determinant,Oe as inverse,Qe as linearDependencies,We as pseudoInverse,Ye as solve,Be as wrap};
